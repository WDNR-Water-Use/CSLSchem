---
title: "CSLS Water Chem Visualization: Lake Stratification"
output: 
  rmarkdown::html_vignette:
    toc: true
vignette: >
  %\VignetteIndexEntry{Lake Temp and DO}
  %\VignetteEngine{knitr::rmarkdown}
  \usepackage[utf8]{inputenc}
---

```{r setup, echo=FALSE, warning=FALSE, message=FALSE}
library(knitr)
library(CSLSchem)
library(dplyr)
library(ggplot2)
library(extrafont)

text_size    <- 12
lakes        <- c("Pleasant", "Long", "Plainfield")
SWIMS        <- CSLSchem::SWIMS

plot_ltmp_HOBO <- function(lake) {
  HOBO     <- CSLSdata::ltmp_HOBO[[lake]]
  max_HOBO <- max(HOBO$date)
  min_HOBO <- min(HOBO$date)
  levels   <- CSLSdata::lake_levels[[lake]]
  levels   <- levels %>%
              filter(date > min_HOBO,
                     date < max_HOBO)
  
  plot_obj <- ggplot() +
              geom_line(data = HOBO,
                        aes(x = date, 
                            y = elev_m,
                            color = ltmp)) +
              geom_line(data = levels,
                        aes(x = date,
                            y = level_m),
                        color = "black",
                        size = 1) +
              scale_x_datetime(breaks = "1 month",
                               date_labels = "%b %y") +
              labs(x = "", 
                   y = "Lake Elevation (m)",
                   title = sprintf("%s Lake Temperature", lake)) +
              scale_color_distiller(name = "Temperature (degC)",
                                    palette = "YlGnBu") +
              theme_bw() +
              theme(text = element_text(family = "Segoe UI Semilight",
                                        size = text_size),
                    panel.grid.major = element_blank(),
                    panel.grid.minor = element_blank(),
                    legend.position = "top")
  return(plot_obj)
}

plot_DO_HOBO <- function(lake) {
  HOBO     <- CSLSdata::DO_HOBO[[lake]]
  max_HOBO <- max(HOBO$date)
  min_HOBO <- min(HOBO$date)
  levels   <- CSLSdata::lake_levels[[lake]]
  levels   <- levels %>%
              filter(date > min_HOBO,
                     date < max_HOBO)
  
  plot_obj <- ggplot() +
              geom_line(data = HOBO,
                        aes(x = date, 
                            y = elev_m,
                            color = DO)) +
              geom_line(data = levels,
                        aes(x = date,
                            y = level_m),
                        color = "black",
                        size = 1) +
              scale_x_datetime(breaks = "1 month",
                               date_labels = "%b %y") +
              labs(x = "", 
                   y = "Lake Elevation (m)",
                   title = sprintf("%s Lake DO", lake)) +
              scale_color_distiller(name = "DO (ppm)",
                                    palette = "YlGnBu") +
              theme_bw() +
              theme(text = element_text(family = "Segoe UI Semilight",
                                        size = text_size),
                    panel.grid.major = element_blank(),
                    panel.grid.minor = element_blank(),
                    legend.position = "top")
  return(plot_obj)
}

```

```{r ltmp, eval=TRUE, echo=FALSE, warning=FALSE, message=FALSE, fig.width=7, fig.height=5, fig.align="center"}

plot_ltmp_HOBO("Pleasant")
plot_DO_HOBO("Pleasant")
plot_ltmp_HOBO("Long")
plot_ltmp_HOBO("Plainfield")

```





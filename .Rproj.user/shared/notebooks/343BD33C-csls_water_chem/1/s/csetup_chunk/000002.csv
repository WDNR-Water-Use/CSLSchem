"0","library(knitr)"
"0","library(H2Ochem)"
"0","library(dplyr)"
"0","library(stringr)"
"0","library(lubridate)"
"0","library(reshape2)"
"0",""
"0","text_size <- 12"
"0",""
"0","plot_bulk_fcn <- function(parameter, plotting_name, text_size, static_gw = TRUE) {"
"0","  SWIMS_parameter <- filter_parameter(parameter = parameter, "
"0","                                      plotting_name = plotting_name,"
"0","                                      static_gw = static_gw)"
"0","  plot_obj <- plot_bulk(SWIMS_parameter, text_size)"
"0","  return(plot_obj)"
"0","}"
"0",""
"0","plot_timeseries_fcn <- function(parameter, plotting_name, text_size, "
"0","                                static_gw = TRUE) {"
"0","  SWIMS_parameter <- filter_parameter(parameter = parameter, "
"0","                                      plotting_name = plotting_name,"
"0","                                      static_gw = static_gw)"
"0","  plot_obj <- plot_timeseries(SWIMS_parameter, text_size)"
"0","  return(plot_obj)"
"0","}"
"0",""
"0","# find_SWIMS_wells <- function(lakes = c(""Pleasant"", ""Long"", ""Plainfield"")){"
"0","#   gw_sites <- NULL"
"0","#   for (lake in lakes){"
"0","#     dictionary  <- cslsdata::dictionary[[lake]]"
"0","#     SWIMS_gw    <- get_SWIMS_gw(lake)"
"0","#     SWIMS_gw$start_date_time <- floor_date(SWIMS_gw$start_date_time, unit = ""week"")"
"0","#     SWIMS_gw           <- unique(SWIMS_gw) %>% na.omit"
"0","#     gw_types           <- dictionary %>%"
"0","#                           filter(.data$obs_type == ""GW"","
"0","#                                  .data$static_iso_class != ""invalid"") %>%"
"0","#                           select(.data$site_id, .data$static_iso_class)"
"0","#     SWIMS_gw           <- merge(SWIMS_gw, gw_types)"
"0","#     SWIMS_gw$site_type <- recode(SWIMS_gw$static_iso_class,"
"0","#                                  ""upgradient"" = ""Upgradient Wells"","
"0","#                                  ""downgradient"" = ""Downgradient Wells"","
"0","#                                  ""invalid"" = ""Invalid"")"
"0","#     SWIMS_gw <- SWIMS_gw %>%"
"0","#                 group_by(.data$start_date_time, .data$site_type) %>%"
"0","#                 mutate(site_ids = str_c(.data$site_id, collapse = "", "")) %>%"
"0","#                 select(.data$start_date_time,"
"0","#                        .data$site_type, "
"0","#                        .data$site_ids) %>%"
"0","#                 unique()"
"0","#     SWIMS_gw <- dcast(SWIMS_gw, start_date_time ~ site_type, value.var = ""site_ids"")"
"0","#     SWIMS_gw$Lake <- lake"
"0","#     colnames(SWIMS_gw)[1] <- ""Week of"""
"0","#     gw_sites <- bind_rows(gw_sites, SWIMS_gw)"
"0","#   }"
"0","#   "
"0","#   gw_sites[is.na(gw_sites)] <- ""--"""
"0","#   "
"0","#   gw_sites <- select(gw_sites, one_of(c('Lake', 'Week of', 'Upgradient Wells', "
"0","#                                         'Downgradient Wells', "
"0","#                                         'Typically Downgradient',"
"0","#                                         'Inconsistent', 'Invalid')))                          "
"0","#   return(gw_sites)"
"0","# }"
"0",""
"0","get_water_level_diff <- function(lakes = c(""Pleasant"", ""Long"", ""Plainfield"")){"
"0","  water_level_diff <- NULL"
"0","  for (lake in lakes){"
"0","    lake_levels <- cslsdata::lake_levels[[lake]]"
"0","    gw_levels   <- cslsdata::gw_levels[[lake]]"
"0","    dictionary  <- cslsdata::dictionary[[lake]]"
"0","    SWIMS       <- cslsdata::SWIMS[[lake]]"
"0","    SWIMS_ids   <- unique(SWIMS$station_id)"
"0","    gw_sites    <- dictionary %>%"
"0","                   filter(.data$obs_type == ""GW"","
"0","                          .data$SWIMS_station_id %in% SWIMS_ids)"
"0",""
"0","        for (i in 1:nrow(gw_levels)) {"
"0","      today <- gw_levels$date[i]"
"0","      gw    <- gw_levels$level_m[i]"
"0","      lk    <- lake_levels$level_m[lake_levels$date == today]"
"0","      if (length(lk) > 0) {"
"0","        gw_levels$diff_m[i] <- gw - lk"
"0","      } else {"
"0","        gw_levels$diff_m[i] <- NA"
"0","      }"
"0","    }"
"0","    gw_levels        <- gw_levels %>%"
"0","                        filter(gw_levels$site_id %in% gw_sites$site_id)"
"0","    water_level_diff <- rbind(water_level_diff, gw_levels)"
"0","  }"
"0","  "
"0","  return(water_level_diff)"
"0","}"
"0",""
"0","get_SWIMS_gw <- function(lakes = c(""Pleasant"", ""Long"", ""Plainfield"")){"
"0","  SWIMS_gw <- NULL"
"0","  for (lake in lakes){"
"0","    SWIMS <- cslsdata::SWIMS[[lake]]"
"0","    dictionary <- cslsdata::dictionary[[lake]]"
"0","    "
"0","    gw_sites <- dictionary %>%"
"0","                filter(.data$obs_type == ""GW"") %>%"
"0","                select(.data$SWIMS_station_id,"
"0","                       .data$site_id)"
"0","    SWIMS    <- SWIMS %>%"
"0","                filter(SWIMS$station_id %in% gw_sites$SWIMS_station_id) %>%"
"0","                mutate(SWIMS_station_id = .data$station_id) %>%"
"0","                select(.data$start_date_time,"
"0","                       .data$SWIMS_station_id)"
"0","    SWIMS    <- merge(SWIMS, gw_sites)"
"0","    SWIMS_gw <- rbind(SWIMS_gw, SWIMS)"
"0","  }"
"0","  return(SWIMS_gw)"
"0","}"
"0",""
